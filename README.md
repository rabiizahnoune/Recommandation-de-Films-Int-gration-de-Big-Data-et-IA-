## Résolution des Problèmes d'Intégration Spark-Elasticsearch

Au cours de l'intégration d'Apache Spark avec Elasticsearch pour stocker les données prétraitées du jeu de données MovieLens, plusieurs problèmes ont émergé, principalement liés à la configuration et à la compatibilité. Initialement, une erreur `SparkClassNotFoundException: [DATA_SOURCE_NOT_FOUND]` est survenue, indiquant que le connecteur `org.elasticsearch.spark.sql` était absent. Cela a été résolu en ajoutant la dépendance `org.elasticsearch:elasticsearch-spark-30_2.12:8.5.1` via `spark.jars.packages`, correspondant à la version d'Elasticsearch 8.5.1 utilisée dans le conteneur Docker. Ensuite, une exception `EsHadoopIllegalArgumentException: Cannot detect ES version` a révélé un problème de détection de version, probablement dû à une connectivité réseau ou à une configuration inadéquate. L’ajout de l’option `es.nodes.wan.only` à `true` a permis de contourner ce problème en désactivant la découverte stricte des nœuds. Enfin, une erreur `Detected type name in resource [movies/_doc]` est apparue en raison de l’utilisation obsolète d’un nom de type (`_doc`) dans Elasticsearch 8.x, où les types multiples ne sont plus supportés. Cette dernière erreur a été corrigée en modifiant `es.resource` de `movies/_doc` à simplement `movies`, alignant ainsi le code avec les normes modernes d’Elasticsearch. Ces ajustements, combinés à une vérification de la connectivité réseau via `requests` et une exécution dans un environnement Docker bien configuré, ont permis de stocker avec succès les données dans l’index `movies`.